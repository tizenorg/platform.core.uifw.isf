<!DOCTYPE html>
<html>
<head>
    <title>Tizen Remote Input</title>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable = 0"/>
    <link rel="stylesheet" href="custom3.css" type="text/css"/>
    <link rel="stylesheet" href="jquery.mobile-1.3.1.css" type="text/css"/>
    <script src="ajaxCaller.js" type="text/javascript"> </script>
    <script src="util.js" type="text/javascript"> </script>
    <script src="jquery-2.0.2.min.js"></script>
    <script src="jquery.mobile-1.3.1.min.js"></script>
    <style type="text/css">
        #bt_circle_X, #bt_circle_Y, #bt_circle_A, #bt_circle_B{
        width: 65x !important;
        height: 65px !important;
        border-radius: 50% !important;
        }
     </style>

    <script>

    </script>


</head>

<body>
    <script>
        // Callback incremental index
        var id_num = 0;

        var KEY_MENU = 10001;
        var KEY_HOME = 10002;
        var KEY_BACK = 10003;

        var GAME_KEY_UP = 111;
        var GAME_KEY_LEFT = 113;
        var GAME_KEY_RIGHT = 114;
        var GAME_KEY_DOWN = 116;
        var GAME_A = 304;
        var GAME_B = 305;
        var GAME_X = 307;
        var GAME_Y = 308;

        var GAME_SELECT = 314;
        var GAME_START = 315;

        var multi_touched = 0;
        var touch_started_x = 0;
        var touch_started_y = 0;
        var touch_contentarea_Pressed=0;
        var touch_contentarea_Moved=0;
        var touch_contentarea_pre_x=0;
        var touch_contentarea_pre_y=0;

        function cbAjax(text, headers, callingContext){
            id_num++;
            return true;
        }
        function sendKeyEvent(keyCode){
            var bodyVars = {id:id_num, key:'event', value:keyCode}
            ajaxCaller.postForPlainText("/tizen-temp.htm", bodyVars, cbAjax);
        }
        function absorbEvent_(event) {

            var e = event || window.event;
            sendKeyEvent(GAME_KEY_UP);
            e.preventDefault && e.preventDefault();
            e.stopPropagation && e.stopPropagation();
            e.cancelBubble = true;
            e.returnValue = false;
            return false;
        }
        function preventLongPressMenu(node) {
            node.ontouchmove = node.ontouchstart;
            //node.ontouchend = absorbEvent_;
            //node.ontouchcancel = absorbEvent_;
        }


        function checkOrientation(){
              var currMode = "";
              alert(window.orientation);
                console.log("check_orientation")
              switch(window.orientation){
                   case 0:
                   currMode = "landscape";
                   break;
                   case -90:
                   currMode = "landscape";
                   break;
                   case 90:
                   currMode = "landscape";
                   break;
                   case 180:
                   currMode = "landscape";
                   break;
             }
             document.getElementsByTagName("body")[0].setAttribute("class", currMode);
        }

        $(document).ready(function() {

         checkOrientation();

          setTimeout(function(){
            window.scrollTo(0, 1);
            }, 0);
            // Disable the long press window
            preventLongPressMenu(document.getElementById('bt_up'));
            preventLongPressMenu(document.getElementById('bt_left'));
            preventLongPressMenu(document.getElementById('bt_right'));
            preventLongPressMenu(document.getElementById('bt_down'));

            // 3 system hw buttons
            $("#sys_btn_menu").click(function(event) {
                sendKeyEvent(KEY_MENU);
            });
            $("#sys_btn_home").click(function(event) {
                sendKeyEvent(KEY_HOME);
            });
            $("#sys_btn_back").click(function(event) {
                sendKeyEvent(KEY_BACK);
            });
            window.onorientationchange = function(){
              checkOrientation();
               }

/*
            // GamePAD control buttons
            $("#bt_up").click(function(event) {
                sendKeyEvent(GAME_KEY_UP);
                //console.log("bt_up");
            });
            $("#bt_left").click(function(event) {
                //console.log("bt_left");
                sendKeyEvent(GAME_KEY_LEFT);
            });
            $("#bt_right").click(function(event) {
                sendKeyEvent(GAME_KEY_RIGHT);
            });
            $("#bt_down").click(function(event) {
                sendKeyEvent(GAME_KEY_DOWN);
            });
*/

            $("#bt_circle_X").click(function(event) {
                sendKeyEvent(GAME_X);
            });
            $("#bt_circle_Y").click(function(event) {
                sendKeyEvent(GAME_Y);
            });
            $("#bt_circle_A").click(function(event) {
                sendKeyEvent(GAME_A);
            });
            $("#bt_circle_B").click(function(event) {
                sendKeyEvent(GAME_B);
            });
            $("#bt_select").click(function(event) {
                sendKeyEvent(GAME_MODE);
            });
            $("#bt_start").click(function(event) {
                sendKeyEvent(GAME_START);
            });

            bt_up.addEventListener("touchstart", function(event) {
                var e = event || window.event;
                sendKeyEvent(GAME_KEY_UP);
                //e.preventDefault && e.preventDefault();
                e.returnValue = false;
                return false;
            });
            bt_down.addEventListener("touchstart", function(event) {
                var e = event || window.event;
                sendKeyEvent(GAME_KEY_DOWN);
                //e.preventDefault && e.preventDefault();
                e.returnValue = false;
                return false;
            });
            bt_left.addEventListener("touchstart", function(event) {
                var e = event || window.event;
                sendKeyEvent(GAME_KEY_LEFT);
                //e.preventDefault && e.preventDefault();
                e.returnValue = false;
                return false;
            });
            bt_right.addEventListener("touchstart", function(event) {
                var e = event || window.event;
                sendKeyEvent(GAME_KEY_RIGHT);
                //e.preventDefault && e.preventDefault();
                e.returnValue = false;
                return false;
            });
            //multi touch drag action for change mode
            content_div.addEventListener("touchstart", function(event) {
                touch_started_x = event.touches[0].pageX;
                touch_started_y = event.touches[0].pageY;
                multi_touched = event.touches.length;
                touch_contentarea_Pressed=1;
                touch_contentarea_Moved=0;
                touch_contentarea_pre_x = event.touches[0].pageX;
                touch_contentarea_pre_y = event.touches[0].pageY;

            });

            content_div.addEventListener("touchmove", function(event) {
                event.preventDefault();
                touch_contentarea_Moved = 1;
                touch_contentarea_pre_x = event.touches[0].pageX;
                touch_contentarea_pre_y = event.touches[0].pageY;
                event.preventDefault();
            });
            content_div.addEventListener("touchend", function(event) {
                if(touch_contentarea_Moved==1 && touch_contentarea_Pressed==1 && multi_touched == 2){
                    if(touch_contentarea_pre_x-touch_started_x == 0){
                        return;
                    }

                    coordinate2= touch_contentarea_pre_x-touch_started_x;
                    if (Math.abs(coordinate2) >=130){
                        window.location='tv_mode.htm';
                    }
                }
                touch_contentarea_Pressed=0;
                touch_contentarea_Moved=0;
            });
        });

    </script>

    <div data-role="page" data-theme="a">

        <div data-role="header">
            <h1><table align=left border=0 width=100%><tr><td align=right><img width=35 src="wifikeyboard.png"></td><td align="center" >Tizen Remote Input</td><td align=left><a href="#" id="mode_change"><img width=35 onclick="window.location='key_mode.htm'" src="keyboard.png"></a></td></tr></table></h1>
        </div> <!-- /header -->

        <div id ="content_div" data-role="content" >

            <div align="center" style="line-height:0em;" >
                <table style="text-align: center;" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                        <td></td>
                        <td><a id="bt_up" href="#" data-role="button" data-icon="arrow-u" data-iconpos="top" data-theme="a" style= "height:65px; width:65px" ><font size="2" style="normal" ></font> </a></td>
                        <td></td>
                        <td colspan="5" rowspan="1"><font size="2" style="font-weight:bold" >TIZEN GAME PAD3</font></td>
                        <td></td>
                        <td style="vertical-align: middle;" align="center"><a id="bt_circle_Y" href="#" data-role="button" data-theme="h" style= "height:60px; width:60px" ><font size="2" style="normal" >Y</font></a></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a id="bt_left" href="#" data-role="button" data-icon="arrow-l" data-iconpos="top" data-theme="a" style= "height:65px; width:65px" ><font size="1" style="normal" ></font> </a></td>
                        <td></td>
                        <td><a id="bt_right" href="#" data-role="button" data-icon="arrow-r" data-iconpos="right" data-theme="a"style= "height:65px; width:65px" ><font size="1" style="normal" ></font> </a></td>
                        <td style="width:20px;"></td>
                        <td style="width:40px;"></td>
                        <td style="width:5px;"></td>
                        <td style="width:40px;"></td>
                        <td style="width:20px;"></td>
                        <td style="vertical-align: middle;" align="center"><a id="bt_circle_X" href="#" data-role="button" data-theme="h"style= "height:60px; width:60px" ><font size="2" style="normal" >X</font> </a></td>
                        <td></td>
                        <td style="vertical-align: middle;" align="center"><a id="bt_circle_B" href="#" data-role="button" data-theme="i"style= "height:60px; width:60px" ><font size="2" style="normal" >B</font> </a></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><a id="bt_down" href="#" data-role="button" data-icon="arrow-d" data-iconpos="bottom" data-theme="a"style= "height:65px; width:65px" ><font size="2" style="normal" ></font> </a></td>
                        <td></td>
                        <td></td>
                        <td valign="bottom"><a id="bt_select" href="#" data-role="button" data-theme="a" style= "height:10px; width:10px" ></a><font size="2" style="normal" ><p>select</font></td>
                        <td></td>
                        <td valign="bottom"><a id="bt_start" href="#" data-role="button" data-theme="i" style= "height:10px; width:10px" ></a><font size="2" style="normal" ><p>start</font></td>
                        <td></td>
                        <td></td>
                        <td style="vertical-align: middle;" align="center"><a id="bt_circle_A" href="#" data-role="button" data-theme="i"style= "height:65px; width:65px" ><font size="2" style="normal" >A</font> </a></td>
                        <td></td>
                    </tr>
                </table>
            </div>
        </div>
        <!-- /content -->

        <div data-role="footer" data-tap-toggle="false" data-position="fixed" style="height:40px">
            <div data-role="navbar" data-grid="b">
                <ul>
                    <li ><a href="#" id="sys_btn_menu" data-icon="bars">Menu</a></li>
                    <li ><a href="#" id="sys_btn_home" data-icon="home">home</a></li>
                    <li><a href="#" id="sys_btn_back" data-icon="back">Back</a></li>
                </ul>
            </div>
        </div>
        <!-- /footer -->
    </div>
    <!-- /page -->

</body>
</html>


